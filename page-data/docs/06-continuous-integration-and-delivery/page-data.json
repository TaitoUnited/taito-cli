{"componentChunkName":"component---src-templates-doc-js","path":"/docs/06-continuous-integration-and-delivery/","result":{"data":{"doc":{"id":"e9639f4a-19eb-55ee-98af-e9ecaaf65fc9","html":"<h2 id=\"6-continuous-integration-and-delivery\" style=\"position:relative;\"><a href=\"#6-continuous-integration-and-delivery\" aria-label=\"6 continuous integration and delivery permalink\" class=\"autolink-a before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Continuous integration and delivery</h2>\n<p>In most cases your CI/CD tool needs only to execute a bunch of simple Taito CLI commands to get the job done. Everything is already configured in taito-config.sh, and Taito CLI provides support for various infrastructures by plugins. This means that you can also easily run any of the CI/CD steps manually from command line using <em>Taito CLI</em>. A typical CI/CD process would consist of the following steps. Run <code class=\"language-text\">taito -h</code> to see decription of the commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Prepare build</span>\ntaito build prepare:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># Prepare all artifacts for deployment (execute in parallel)</span>\ntaito artifact prepare:client:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito artifact prepare:server:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Deploy the changes to target environment</span>\n<span class=\"token punctuation\">(</span>taito <span class=\"token function\">env</span> apply:<span class=\"token variable\">$BRANCH</span><span class=\"token punctuation\">)</span>\ntaito db deploy:<span class=\"token variable\">$BRANCH</span>\ntaito deployment deploy:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Test and verify deployment</span>\ntaito deployment wait:<span class=\"token variable\">$BRANCH</span>\ntaito test:<span class=\"token variable\">$BRANCH</span>\ntaito deployment verify:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># Release all artifacts (execute in parallel)</span>\ntaito artifact release:client:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito artifact release:server:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Release build</span>\ntaito build release:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># ON FAIL: Revert deployment on fail</span>\ntaito deployment revert:<span class=\"token variable\">$BITBUCKET_BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito db revert:<span class=\"token variable\">$BITBUCKET_BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span></code></pre></div>\n<p>If you want your CI/CD to do more that it currently does, try not to add more CI/CD steps. Instead, enable plugins or add project specific custom commands that do additional operations within the current CI/CD steps. This way CI/CD scripts remain reusable and CI/CD pipeline consists of standard steps that can be easily run either automatically or manually. For example, if you want to do something extra at the end of the CI/CD script, just enable some plugin that executes the additional operation on <code class=\"language-text\">taito build release</code>, or add a custom command to your package.json (e.g. <code class=\"language-text\">\"build-release\": \"echo 'Do something extra'\"</code>).</p>\n<h3 id=\"cicd-optimized-docker-images\" style=\"position:relative;\"><a href=\"#cicd-optimized-docker-images\" aria-label=\"cicd optimized docker images permalink\" class=\"autolink-a before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CI/CD optimized Docker images</h3>\n<p>Taito CLI <a href=\"https://github.com/TaitoUnited/taito-cli/pkgs/container/taito-cli\">container repository</a> provides the following stable Docker images optimized for CI/CD:</p>\n<ul>\n<li><code class=\"language-text\">ci</code>: CI/CD image without any cloud provider specific tools.</li>\n<li><code class=\"language-text\">ci-aws</code>: CI/CD image for <strong>Amazon Web Services</strong>.</li>\n<li><code class=\"language-text\">ci-azure</code>: CI/CD image for <strong>Microsoft Azure</strong>.</li>\n<li><code class=\"language-text\">ci-gcp</code>: CI/CD image for <strong>Google Cloud Platform</strong>.</li>\n<li><code class=\"language-text\">ci-do</code>: CI/CD image for <strong>Digital Ocean</strong>.</li>\n<li><code class=\"language-text\">ci-openshift</code>: CI/CD image for <strong>OpenShift</strong>.</li>\n<li><code class=\"language-text\">ci-all</code>: CI/CD image that includes tools for all cloud providers.</li>\n</ul>\n<p>If your CI/CD pulls the whole Docker image on each build, optimize the image pull by setting up caching on your CI/CD, or by using your own Docker registry as a mirror. You can also create a custom Docker image, that includes only the tools that you actually need.</p>\n<h3 id=\"deployment-to-multiple-platforms\" style=\"position:relative;\"><a href=\"#deployment-to-multiple-platforms\" aria-label=\"deployment to multiple platforms permalink\" class=\"autolink-a before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment to multiple platforms</h3>\n<p>You can deploy the same application to multiple platforms. For example, your development and testing environments may reside on Google Cloud Platform to enable easy access for external personnel. Furthermore, your staging, canary, and production environments may reside on-premises to fulfill extra security requirements. You can define separate settings for each environment (local, dev, test, prod, ...) in your project specific <code class=\"language-text\">taito-config.sh</code> file. Furthermore, if you look at the template settings in your <code class=\"language-text\">~/.taito/taito-config.sh</code> file, you may notice that there is a separate production zone definition (<code class=\"language-text\">template_default_*_prod</code>). By modifying these settings, you may define that staging, canary and production environments of a newly created project is deployed to different zone than development and testing environments.</p>\n<p>You may even deploy the same git branch simultaneously to multiple platforms.\nThe <a href=\"https://github.com/TaitoUnited/full-stack-template\">full-stack-template</a> supports <code class=\"language-text\">TAITO_CONFIG_OVERRIDE</code> environment variable for configuration overrides. Just define path to a configuration overrides file in your CI/CD script with the <code class=\"language-text\">TAITO_CONFIG_OVERRIDE</code> environment variable, and it will be included in the configuration settings just before <code class=\"language-text\">scripts/taito/config/provider.sh</code>. The file may be either local file (e.g. <code class=\"language-text\">./my-overrides.sh</code>) or remote (e.g. <code class=\"language-text\">https://mydomain.com/configs/my-overrides.sh</code>).</p>\n<h3 id=\"cicd-without-taito-cli\" style=\"position:relative;\"><a href=\"#cicd-without-taito-cli\" aria-label=\"cicd without taito cli permalink\" class=\"autolink-a before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CI/CD without Taito CLI</h3>\n<p>If you for some reason cannot use Taito CLI in your CI/CD pipeline, you can easily implement the CI/CD steps yourself. First run each step manually with the verbose option (<code class=\"language-text\">taito -v</code>) to see the commands that Taito CLI executes under the hood. Then implement your CI/CD script based on those commands. You can also use <code class=\"language-text\">taito-config.sh</code> environment variables in your CI/CD script:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">taito_target_env</span><span class=\"token operator\">=</span><span class=\"token variable\">${BRANCH<span class=\"token operator\">/</span>master<span class=\"token operator\">/</span>prod}</span>\n<span class=\"token builtin class-name\">.</span> taito-config.sh</code></pre></div>\n<p>Note that the CI/CD process may slightly differ depending on environment. On dev and feature environments the artifacts are usually tagged using <code class=\"language-text\">untested</code> suffix, and on prod environment some additional steps are taken during <code class=\"language-text\">taito build release</code> to generate release notes, etc.</p>\n<hr>\n<p><strong>Next:</strong> <a href=\"/taito-cli/docs/07-infrastructure-management\">7. Infrastructure management</a></p>"},"menu":{"edges":[{"node":{"id":"79314656-aed3-521a-a053-d628a7e651cb","headings":[{"value":"1. Introduction"}],"fields":{"slug":"/docs/01-introduction/"}}},{"node":{"id":"7d77d8b9-6bf8-5860-bca7-302b11a9af44","headings":[{"value":"2. Installation and upgrade"}],"fields":{"slug":"/docs/02-installation/"}}},{"node":{"id":"3bee052f-607d-5da4-b4af-d4f301d47794","headings":[{"value":"3. Quick start"}],"fields":{"slug":"/docs/03-quick-start/"}}},{"node":{"id":"3c25a777-98fb-5d17-bbcb-8572aee95c90","headings":[{"value":"4. Usage"}],"fields":{"slug":"/docs/04-usage/"}}},{"node":{"id":"2d652844-de5c-5131-b621-b72e9bde78aa","headings":[{"value":"5. Configuration"}],"fields":{"slug":"/docs/05-configuration/"}}},{"node":{"id":"e9639f4a-19eb-55ee-98af-e9ecaaf65fc9","headings":[{"value":"6. Continuous integration and delivery"}],"fields":{"slug":"/docs/06-continuous-integration-and-delivery/"}}},{"node":{"id":"84d3f423-ca98-5111-b813-c7951b0e8c90","headings":[{"value":"7. Infrastructure management"},{"value":"Creating a zone"}],"fields":{"slug":"/docs/07-infrastructure-management/"}}},{"node":{"id":"5f31b865-4088-56b0-b570-6aced955ace6","headings":[{"value":"8. ChatOps"}],"fields":{"slug":"/docs/08-chatops/"}}},{"node":{"id":"08681f6a-d2da-5115-b5ad-62d2fc809255","headings":[{"value":"9. Custom commands"}],"fields":{"slug":"/docs/09-custom-commands/"}}},{"node":{"id":"8802860b-68c5-546b-aa20-3aee0d1f3380","headings":[{"value":"10. Custom plugins"}],"fields":{"slug":"/docs/10-custom-plugins/"}}},{"node":{"id":"f2d2d148-831b-527a-96c9-fed2df9e97bd","headings":[{"value":"11. Custom project templates"}],"fields":{"slug":"/docs/11-custom-project-templates/"}}},{"node":{"id":"854e0764-f7ea-5e46-b19d-9e86ee63ab1d","headings":[{"value":"12. Taito CLI development"}],"fields":{"slug":"/docs/12-taito-cli-development/"}}}]}},"pageContext":{"id":"e9639f4a-19eb-55ee-98af-e9ecaaf65fc9"}},"staticQueryHashes":["876164431"]}