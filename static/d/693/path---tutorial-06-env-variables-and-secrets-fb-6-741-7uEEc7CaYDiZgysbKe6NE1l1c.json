{"data":{"markdownRemark":{"id":"81897738-dd3b-5209-b61b-87db02fd9fb4","html":"<h2>6. Environment variables and secrets</h2>\n<p>TODO describe:</p>\n<ul>\n<li>docker-compose.yaml</li>\n<li>scripts/helm.yaml</li>\n<li>scripts/helm-ENV.yaml</li>\n</ul>\n<h3>6.1. Define an environment variable: same value for all environments</h3>\n<p>Add the variable to docker-compose.yaml for local development:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">environment:\n  MY_VARIABLE: my_value</code></pre></div>\n<p>Add the variable to scripts/helm.yaml:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">env:\n  MY_VARIABLE: my_value</code></pre></div>\n<h3>6.2. Define an environment variable: different value for each environment</h3>\n<p>Add the variable to docker-compose.yaml for local development:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">environment:\n  MY_VARIABLE: my_value</code></pre></div>\n<p>Add default value for the variable to scripts/helm.yaml:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">env:\n  MY_VARIABLE: my_value</code></pre></div>\n<p>Add environment specific value to <code class=\"language-text\">scripts/helm-ENV.yaml</code> file for such environments that do not use the default value:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">env:\n  MY_VARIABLE: my_value</code></pre></div>\n<h3>6.3. Deploy a configuration changes without rebuilding</h3>\n<p>First make the configuration changes and push them to dev branch. Then deploy the configuration changes directly to different environments:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">taito deployment deploy:stag\ntaito deployment deploy:prod</code></pre></div>\n<blockquote>\n<p>TODO: Currently you always need to give image tag as a parameter. See the latest image tag deployed successfully for the branch in question by running <code class=\"language-text\">taito open builds</code>.</p>\n</blockquote>\n<h3>6.4. Define a secret</h3>\n<p>taito-config.sh:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">taito_secrets<span class=\"token operator\">=</span><span class=\"token string\">\"\n  <span class=\"token variable\">${taito_project}</span>-<span class=\"token variable\">${taito_env}</span>-my-secret.key:manual\n\"</span></code></pre></div>\n<p>helm.yaml:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">secrets:\n  MY_SECRET_KEY: <span class=\"token variable\">${taito_project}</span>-<span class=\"token variable\">${taito_env}</span>-my-secret.key</code></pre></div>\n<p>docker-compose.yaml:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">environment:\n  MY_SECRET_KEY: <span class=\"token variable\">${acme-myproject-dev-my-secret-key}</span></code></pre></div>\n<p>Set secret value for each environment:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">taito <span class=\"token function\">env</span> rotate:dev my-secret\ntaito <span class=\"token function\">env</span> rotate:test my-secret\ntaito <span class=\"token function\">env</span> rotate:prod my-secret</code></pre></div>\n<blockquote>\n<p>TODO: Describe how to use the same secret value for local and dev environment without committing it to git.</p>\n</blockquote>\n<h3>6.5. User specific variables</h3>\n<p>TODO</p>\n<hr>\n<p><strong>Next:</strong> <a href=\"/tutorial/07-databases-and-files\">7. Databases and files</a></p>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"81897738-dd3b-5209-b61b-87db02fd9fb4"}}