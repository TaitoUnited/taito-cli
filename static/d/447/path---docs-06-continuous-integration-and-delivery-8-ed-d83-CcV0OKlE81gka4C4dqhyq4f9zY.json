{"data":{"doc":{"id":"dc734f9a-57ec-5a05-8a3d-0139d8fb7952","html":"<h2>6. Continuous integration and delivery</h2>\n<p>In most cases your CI/CD tool needs only to execute a bunch of simple Taito CLI commands to get the job done. Everything is already configured in taito-config.sh, and Taito CLI provides support for various infrastructures by plugins. This means that you can also easily run any of the CI/CD steps manually from command line using <em>Taito CLI</em>. A typical CI/CD process would consist of the following steps. Run <code class=\"language-text\">taito -h</code> to see decription of the commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Prepare build</span>\ntaito build prepare:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># Prepare all artifacts for deployment (execute in parallel)</span>\ntaito artifact prepare:client:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito artifact prepare:server:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Deploy the changes to target environment</span>\n<span class=\"token punctuation\">(</span>taito <span class=\"token function\">env</span> apply:<span class=\"token variable\">$BRANCH</span><span class=\"token punctuation\">)</span>\ntaito db deploy:<span class=\"token variable\">$BRANCH</span>\ntaito deployment deploy:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Test and verify deployment</span>\ntaito deployment wait:<span class=\"token variable\">$BRANCH</span>\ntaito test:<span class=\"token variable\">$BRANCH</span>\ntaito deployment verify:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># Release all artifacts (execute in parallel)</span>\ntaito artifact release:client:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito artifact release:server:<span class=\"token variable\">$BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\n\n<span class=\"token comment\"># Release build</span>\ntaito build release:<span class=\"token variable\">$BRANCH</span>\n\n<span class=\"token comment\"># ON FAIL: Revert deployment on fail</span>\ntaito deployment revert:<span class=\"token variable\">$BITBUCKET_BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span>\ntaito db revert:<span class=\"token variable\">$BITBUCKET_BRANCH</span> <span class=\"token variable\">$COMMIT_SHA</span></code></pre></div>\n<p>If you want your CI/CD to do more that it currently does, try not to add more CI/CD steps. Instead, enable plugins or add custom commands that do additional operations within the current CI/CD steps. For example, if you want to do something extra at the end of the CI/CD script, just enable some plugin that executes the additional operation on <code class=\"language-text\">taito build release</code>, or add a custom command to your package.json (e.g. <code class=\"language-text\">&quot;build-release&quot;: &quot;echo &#39;Do something extra&#39;&quot;</code>).</p>\n<h3>CI/CD without Taito CLI</h3>\n<p>If you for some reason cannot use Taito CLI in your CI/CD pipeline, you can easily implement the CI/CD steps yourself. First run each step manually with the verbose option (<code class=\"language-text\">taito -v</code>) to see the commands that Taito CLI executes under the hood. Then implement your CI/CD script based on those commands. You can also use <code class=\"language-text\">taito-config.sh</code> environment variables in your CI/CD script:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">set</span> -a\ntaito_target_env<span class=\"token operator\">=</span><span class=\"token variable\">${BRANCH/master/prod}</span>\n<span class=\"token keyword\">.</span> taito-config.sh\n<span class=\"token keyword\">set</span> +a</code></pre></div>\n<p>Note that the CI/CD process may slightly differ depending on branch. On dev and feature branches the artifacts are usually tagged using <code class=\"language-text\">untested</code> suffix, and on master branch some additional steps are taken during <code class=\"language-text\">taito build release</code> to generate release notes, etc.</p>\n<hr>\n<p><strong>Next:</strong> <a href=\"/docs/07-infrastructure-management\">7. Infrastructure management</a></p>"},"menu":{"edges":[{"node":{"id":"2b027433-6a58-52a1-be40-77a8b9d90bbb","headings":[{"value":"1. Introduction"}],"fields":{"slug":"/docs/01-introduction/"}}},{"node":{"id":"8e65c957-121e-5710-8cd9-25bcc970582e","headings":[{"value":"2. Installation and upgrade"}],"fields":{"slug":"/docs/02-installation/"}}},{"node":{"id":"d23fc3f3-90f5-5d4a-8e84-7c1df2e22706","headings":[{"value":"3. Quick start"}],"fields":{"slug":"/docs/03-quick-start/"}}},{"node":{"id":"fc5df1c6-fcda-5d43-9ac0-46826f181003","headings":[{"value":"4. Usage"}],"fields":{"slug":"/docs/04-usage/"}}},{"node":{"id":"38692359-aea8-589d-8942-9675abf88257","headings":[{"value":"5. Configuration"}],"fields":{"slug":"/docs/05-configuration/"}}},{"node":{"id":"dc734f9a-57ec-5a05-8a3d-0139d8fb7952","headings":[{"value":"6. Continuous integration and delivery"}],"fields":{"slug":"/docs/06-continuous-integration-and-delivery/"}}},{"node":{"id":"52d72360-81b4-51df-bcbe-7cdd53a97c99","headings":[{"value":"7. Infrastructure management"},{"value":"Creating a zone"}],"fields":{"slug":"/docs/07-infrastructure-management/"}}},{"node":{"id":"127dd890-053d-5afb-b264-d285bdd10b64","headings":[{"value":"8. ChatOps"}],"fields":{"slug":"/docs/08-chatops/"}}},{"node":{"id":"f9a10cba-5a5f-521c-82dd-5cbae69b14e4","headings":[{"value":"9. Custom commands"}],"fields":{"slug":"/docs/09-custom-commands/"}}},{"node":{"id":"0868a447-c5d2-5d9b-b19a-e00380febcb1","headings":[{"value":"10. Custom plugins"}],"fields":{"slug":"/docs/10-custom-plugins/"}}},{"node":{"id":"56c8224f-77fd-5b8e-9b0c-92a8b978765d","headings":[{"value":"11. Custom project templates"}],"fields":{"slug":"/docs/11-custom-project-templates/"}}},{"node":{"id":"c0a966b4-66e2-5535-bfa3-4b6a44833991","headings":[{"value":"12. Taito CLI development"}],"fields":{"slug":"/docs/12-taito-cli-development/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"dc734f9a-57ec-5a05-8a3d-0139d8fb7952"}}